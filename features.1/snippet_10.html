<!DOCTYPE html>
<html>
<head>
    <title>OBJ Mesh Upload & Visualization</title>
</head>
<body>
<h1>Upload OBJ Mesh</h1>
<form action="/upload" method="post" enctype="multipart/form-data">
    <input type="file" name="mesh" accept=".obj" required>
    <button type="submit">Upload</button>
</form>

<div id="result"></div>
<div id="image"></div>

<script>
    const form = document.querySelector('form');
    const resultDiv = document.getElementById('result');
    const imageDiv = document.getElementById('image');

    form.onsubmit = async (e) => {
        e.preventDefault();
        const formData = new FormData(form);

        const res = await fetch('/upload', {
            method: 'POST',
            body: formData
        });
        const json = await res.json();
        if (res.ok) {
            resultDiv.textContent = json.message + ` | Vertices: ${json.vertices}`;
            // Show visualization image
            const imgRes = await fetch('/visualize');
            if (imgRes.ok) {
                const blob = await imgRes.blob();
                const url = URL.createObjectURL(blob);
                imageDiv.innerHTML = `<img src="${url}" width="400"/>`;
            }
        } else {
            resultDiv.textContent = json.error || 'Error uploading mesh';
        }
    };
</script>
</body>
</html>
